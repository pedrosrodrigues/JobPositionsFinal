<ui:composition xmln="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

	<div id="loginfrm">
		<h:form id="frm">
		
			<p:dataTable value="#{jobPositionBean.jobpositions}" var="position"
				rows="8" emptyMessage="No records found." paginator="true"
				paginatorPosition="bottom"
				paginatorTemplate=" {FirstPageLink} {PreviousPageLink}
						 {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				id="jobstable" sortMode="single">

				<p:column styleClass="jobs-table" headerText="Job Title"
					style="text-align: center; width:170px" sortBy="#{position.title}"  filterBy="#{position.title}">
					<h:outputText value="#{position.title}" />
				</p:column>
				<p:column styleClass="jobs-table" headerText="Company"
					style="text-align: center; width:170px"
					sortBy="#{position.company}">
					<h:outputText value="#{position.company}" />
				</p:column>
				<p:column headerText="Technical Area"
					style="text-align: center; width:140px"
					sortBy="#{position.technicalArea}">
					<h:outputText value="#{position.technicalArea}" />
				</p:column>
				<p:column headerText="Job Code"
					style="text-align: center; width:60px" sortBy="#{position.id}">
					<h:outputText value="JP-#{position.id}" />
				</p:column>
				<p:column headerText="Location"
					style="text-align: center; width:140px"
					sortBy="#{position.location}">
					<h:outputText value="#{position.location}" />
				</p:column>
				<p:column headerText="Final date"
					style="text-align: center; width:120px"
					sortBy="#{position.finalDate}">
					<h:outputText value="#{position.finalDate}">
						<f:convertDateTime pattern="dd/MM/yyyy" />
					</h:outputText>
				</p:column>
				<p:column headerText="Job Status"
					style="text-align: center; width:120px"
					sortBy="#{position.jobStatus}">
					<h:outputText value="#{position.jobStatus}" />
				</p:column>
				<p:column headerText="Edit" style="text-align: center; width:40px;">
					<p:commandButton icon="ui-icon-pencil"
						action="#{jobPositionBean.jobInfo(position.id)}"
						update="tab:editpositiofrm:panel" oncomplete="PF('dlg3').show();" />
				</p:column>
				<p:column headerText="Candidates"
					style="text-align: center; width:40px;">
					<p:commandButton icon="ui-icon-person"
						action="#{applicationBean.searchCandidates(position.id)}"
						update="tab:candidatesform:candidatesforposition"
						oncomplete="PF('dlg2').show();" />
				</p:column>

				<p:column style="width:16px">
					<p:rowToggler />
				</p:column>
				<p:rowExpansion id="rowselection">
					<p:panelGrid columns="2" columnClasses="label, field"
						style="width:100%;">

						<h:outputText value="# of openings" />
						<h:outputText value="#{position.vacancies}" />

						<h:outputText value="Responsable" />
						<h:outputText value="#{position.responsable}" />
					</p:panelGrid>

					<p:panelGrid columns="1" style="width:100%;">
						<h:outputText value="#{position.jobDescription}" />
					</p:panelGrid>
				</p:rowExpansion>
			</p:dataTable>

		</h:form>

		<h:form id="candidatesform">
			<p:dialog header="Candidates" widgetVar="dlg2" modal="true"
				height="300" weight="100">
				<p:dataTable id="candidatesforposition"
					value="#{applicationBean.listPosApp}" var="candlist" rows="10"
					emptyMessage="No records found." paginator="true"
					paginatorPosition="bottom"
					paginatorTemplate=" {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

					<p:column styleClass="jobs-table" headerText="Name"
						style="text-align: center; width:200px"
						sortBy="#{candlist.candidateEntity.firstname}">
						<h:outputText
							value="#{candlist.candidateEntity.firstname} #{candlist.candidateEntity.lastname}" />
						<p:rowToggler />
					</p:column>
					<p:rowExpansion id="rowselection">
						<p:panelGrid columns="2" columnClasses="label, field"
							style="width:100%;">

							<h:outputText value="City" />
							<h:outputText value="#{candlist.candidateEntity.city}" />

							<h:outputText value="Mobile" />
							<h:outputText value="#{candlist.candidateEntity.mobile}" />

						</p:panelGrid>
					</p:rowExpansion>
					<p:column styleClass="jobs-table" headerText="Email"
						style="text-align: center; width:200px"
						sortBy="#{candlist.candidateEntity.email}">
						<h:outputText value="#{candlist.candidateEntity.email}" />
					</p:column>
					<p:column headerText="Application Status"
						style="text-align: center; width:140px"
						sortBy="#{candlist.appStatus}">
						<p:selectOneMenu id="appstatus" value="#{candlist.appStatus}"
							required="true">
							<f:selectItem id="item1" itemLabel="Submitted"
								itemValue="SUBMITTED" />
							<f:selectItem id="item2" itemLabel="Interviewing"
								itemValue="INTERVIEWING" />
							<f:selectItem id="item3" itemLabel="Negotiation"
								itemValue="NEGOTIATION" />
							<f:selectItem id="item4" itemLabel="Rejected"
								itemValue="REJECTED" />
							<f:selectItem id="item5" itemLabel="Hired" itemValue="HIRED" />
						</p:selectOneMenu>
					</p:column>
					<p:column styleClass="jobs-table" headerText="Save"
						style="text-align: center; width:200px">
						<p:commandButton icon="ui-icon-disk"
							action="#{applicationBean.updateApp(candlist.id)}" />
					</p:column>
				</p:dataTable>
			</p:dialog>
		</h:form>

		<h:form id="editpositiofrm">
			<p:dialog header="Edit Job Position" widgetVar="dlg3" modal="true"
				height="300" weight="300">
				<p:messages id="messageForm2" closable="true" />
				<p:panel id="panel" style="border-width: 0px;">
					<h:panelGrid styleClass="inputTable" columns="2" cellpadding="4px"
						cellspacing="4px">
						<h:panelGrid styleClass="inputTable2" columns="2"
							cellpadding="4px" cellspacing="4px">

							<p:outputLabel value="Date (start)" for="startDate" />
							<p:outputLabel value="Date (end)" for="endDate" />
							<p:calendar id="startDate"
								value="#{jobPositionBean.creationDate}" readonlyInput="true"
								requiredMessage="Please Select Date Of Registration"
								style="width:10%;" />
							<p:calendar id="endDate" value="#{jobPositionBean.finalDate}"
								style="width:10%;" />
						</h:panelGrid>
						<h:panelGrid columns="2" cellpadding="4px" cellspacing="4px">
							<p:outputLabel value="SLA" for="sla" />
							<p:outputLabel value="Job Code" for="jcode" />

							<p:inputText id="sla" value="#{jobPositionBean.sla}"
								style="width:100%;" />
							<p:inputText id="jcode" value="#{jobPositionBean.positionCode}"
								style="width:100%;" />
						</h:panelGrid>

						<p:outputLabel value="Title" for="title" />
						<p:outputLabel value="Location" for="location" />

						<p:inputText id="title" value="#{jobPositionBean.title}" />
						<p:inputText id="location" value="#{jobPositionBean.location}" />

						<p:outputLabel value="Vacancies" for="vacancies" />
						<p:outputLabel value="Responsable" for="responsable" />

						<p:inputText id="vacancies" value="#{jobPositionBean.vacancies}" />
						<p:inputText id="responsable"
							value="#{jobPositionBean.responsable}" />

						<p:outputLabel value="Technical Area" for="tarea" />
						<p:outputLabel value="Company" for="company" />

						<p:inputText id="tarea" value="#{jobPositionBean.technicalArea}" />
						<p:inputText id="company" value="#{jobPositionBean.company}" />

						<p:outputLabel value="Job description" for="description" />
						<p:outputLabel />

						<p:inputTextarea id="description"
							value="#{jobPositionBean.jobDescription}" cols="40" rows="4"
							autoResize="false" />
					</h:panelGrid>
				</p:panel>
			</p:dialog>

		</h:form>
	</div>
</ui:composition>